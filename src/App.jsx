import React, { useState, useEffect, useRef } from 'react';
import { Download, Upload, Calendar, Image as ImageIcon, FileText, Loader, AlertCircle } from 'lucide-react';

// --- CONFIGURAÇÃO DE IMAGENS PADRÃO E AUTOMÁTICAS ---
// ?v=2 para forçar atualização de cache
const FUNDO_MAP = {
  '1 MÊS': {
    ouro: '/img_fundos/fundo_1mes.jpg?v=2',
    box_k: '/img_fundos/fundo_1mes_boxk.jpg?v=2'
  },
  '3 MESES': {
    ouro: '/img_fundos/fundo_3meses.jpg?v=2',
    box_k: '/img_fundos/fundo_3meses_boxk.jpg?v=2'
  },
  '6 MESES': {
    ouro: '/img_fundos/fundo_6meses.jpg?v=2',
    box_k: '/img_fundos/fundo_6meses_boxk.jpg?v=2'
  },
  '1 ANO': {
    ouro: '/img_fundos/fundo_1ano.jpg?v=2',
    box_k: '/img_fundos/fundo_1ano_boxk.jpg?v=2'
  },
};

// Utilitário para adicionar meses a uma data
const addMonths = (date, months) => {
  const d = new Date(date);
  d.setMonth(d.getMonth() + months);
  return d;
};

// Formata data para PT-BR
const formatDate = (dateStr) => {
  if (!dateStr) return '';
  const [year, month, day] = dateStr.split('-');
  return `${day}/${month}/${year}`;
};

export default function App() {
  const [periodo, setPeriodo] = useState('1 MÊS');
  const [nomeEvento, setNomeEvento] = useState('');
  const [artigoEvento, setArtigoEvento] = useState('ao');
  const [plano, setPlano] = useState('ouro'); 
  const [dataRetirada, setDataRetirada] = useState(new Date().toISOString().split('T')[0]);
  const [fundoCertificado, setFundoCertificado] = useState(FUNDO_MAP['1 MÊS'].ouro || null);
  const [isGenerating, setIsGenerating] = useState(false);
  const certificateRef = useRef(null);

  useEffect(() => {
    const loadScript = (src) => {
      return new Promise((resolve, reject) => {
        if (document.querySelector(`script[src="${src}"]`)) {
          resolve();
          return;
        }
        const script = document.createElement('script');
        script.src = src;
        script.onload = resolve;
        script.onerror = reject;
        document.body.appendChild(script);
      });
    };

    Promise.all([
      loadScript('https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js'),
      loadScript('https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js')
    ]).then(() => {
      console.log('Bibliotecas de exportação carregadas');
    }).catch(err => console.error('Erro ao carregar bibliotecas', err));
  }, []);

  useEffect(() => {
    const opcoesPeriodo = FUNDO_MAP[periodo];
    if (opcoesPeriodo) {
      const novoFundo = opcoesPeriodo[plano];
      if (novoFundo) {
        setFundoCertificado(novoFundo);
      }
    }
  }, [periodo, plano]);

  useEffect(() => {
    if (!nomeEvento) return;
    const primeiroNome = nomeEvento.split(' ')[0].toLowerCase();
    const femininas = ['corrida', 'maratona', 'semana', 'jornada', 'aula', 'sessão', 'gincana', 'festa', 'confraternização', 'caminhada'];
    if (femininas.includes(primeiroNome) || (primeiroNome.endsWith('a') && !['dia', 'cinema', 'programa'].includes(primeiroNome))) {
      setArtigoEvento('à');
    } else {
      setArtigoEvento('ao');
    }
  }, [nomeEvento]);

  const getPeriodoExtenso = (p) => {
    const map = {
      '1 MÊS': 'um mês',
      '3 MESES': 'três meses',
      '6 MESES': 'seis meses',
      '1 ANO': 'um ano',
      'OUTRO': 'período'
    };
    return map[p] || p.toLowerCase();
  };

  const formatarNomeEvento = (texto) => {
    if (!texto) return '';
    if (texto === texto.toUpperCase() && texto.trim().length > 0) return texto;
    const excecoes = ['de', 'da', 'do', 'das', 'dos', 'e', 'em', 'na', 'no', 'nas', 'nos', 'para', 'por', 'a', 'o', 'as', 'os', 'ao', 'aos', 'à', 'às'];
    return texto.toLowerCase().split(' ').map((palavra, index) => {
      if (index > 0 && excecoes.includes(palavra)) return palavra;
      return palavra.charAt(0).toUpperCase() + palavra.slice(1);
    }).join(' ');
  };

  const handleImageUpload = (e, setter) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (x) => setter(x.target.result);
      reader.readAsDataURL(file);
    }
  };

  const prepareCanvas = async () => {
    if (!window.html2canvas) throw new Error("Biblioteca html2canvas não carregada.");
    const canvas = await window.html2canvas(certificateRef.current, {
      scale: 2,
      useCORS: true,
      allowTaint: true,
      backgroundColor: '#ffffff',
    });
    return canvas;
  };

  const downloadJPG = async () => {
    setIsGenerating(true);
    try {
      const canvas = await prepareCanvas();
      const image = canvas.toDataURL("image/jpeg", 1.0);
      const link = document.createElement('a');
      link.download = `Certificado-${periodo.replace(' ', '-')}-${nomeEvento || 'Evento'}.jpg`;
      link.href = image;
      link.click();
    } catch (error) {
      console.error("Erro ao gerar JPG:", error);
      alert("Erro ao gerar imagem. Tente novamente.");
    } finally {
      setIsGenerating(false);
    }
  };

  const downloadPDF = async () => {
    setIsGenerating(true);
    try {
      const canvas = await prepareCanvas();
      const imgData = canvas.toDataURL('image/jpeg', 1.0);
      if (!window.jspdf) throw new Error("Biblioteca jspdf não carregada.");
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF('l', 'mm', 'a4');
      const pdfWidth = pdf.internal.pageSize.getWidth();
      const pdfHeight = pdf.internal.pageSize.getHeight();
      pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight);
      pdf.save(`Certificado-${periodo.replace(' ', '-')}.pdf`);
    } catch (error) {
      console.error("Erro ao gerar PDF:", error);
      alert("Erro ao gerar PDF. Tente novamente.");
    } finally {
      setIsGenerating(false);
    }
  };

  const dataFinal = formatDate(addMonths(dataRetirada, 1).toISOString().split('T')[0]);
  const dataRetiradaFormatada = formatDate(dataRetirada);

  return (
    <div className="min-h-screen bg-gray-100 font-sans flex flex-col md:flex-row">
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400;1,500&display=swap');
        .font-bebas { font-family: 'Bebas Neue', cursive; font-weight: 400; }
        .font-garamond { font-family: 'EB Garamond', serif; }
        @media print {
          .no-print { display: none !important; }
          .print-area { 
            transform: scale(1) !important; 
            width: 100% !important;
            height: 100vh !important;
            margin: 0 !important;
            border: none !important;
            box-shadow: none !important;
            page-break-after: always;
          }
          body { background: white; }
          @page { size: landscape; margin: 0; }
        }
      `}</style>

      {/* --- MENU LATERAL (Esquerda) --- */}
      <div className="no-print w-full md:w-1/3 lg:w-1/4 bg-white p-6 shadow-lg overflow-y-auto z-10 border-r border-gray-200 h-screen sticky top-0 flex flex-col">
        
        {/* CONTEÚDO SCROLLÁVEL */}
        <div className="flex-1 overflow-y-auto">
          {/* LOGO SVG - CUIDADO AO COLAR AQUI */}
          <div className="mb-8">
            {/* IMPORTANTE: 
              1. Apague a linha que começa com <?xml ... ?>
              2. Apague a linha que começa com <!-- Generator ... -->
              3. Cole apenas a tag <svg ...> até </svg>
            */}
            <?xml version="1.0" encoding="UTF-8"?>
<svg id="Camada_1" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 825.99 359.22">
  <path d="M168.04,293.11c-1.55,2.53-3.66,5.3-6.32,8.33-2.67,3.02-5.94,5.8-9.8,8.33-3.87,2.53-8.29,4.64-13.28,6.32-4.99,1.69-10.43,2.53-16.34,2.53-14.9,0-27.23-2.63-36.99-7.9-9.77-5.27-17.15-12.3-22.13-21.08-4.99-8.78-7.69-18.86-8.12-30.25s1.16-23.22,4.74-35.52c3.58-12.3,9.1-24.63,16.55-37,7.45-12.36,16.58-23.82,27.4-34.36-5.34,0-10.61.21-15.81.63-5.2.42-10.26,1.34-15.18,2.74-4.92,1.41-9.77,3.41-14.54,6.01-4.78,2.6-9.42,6.08-13.91,10.43-4.36,4.08-7.52,8.4-9.49,12.96-1.97,4.57-2.88,8.96-2.74,13.17.14,4.22,1.16,8.01,3.06,11.38s4.46,5.9,7.69,7.59l-9.06,4.64c-2.67-.28-5.62-1.4-8.85-3.37-3.23-1.97-6.29-4.57-9.17-7.8-2.88-3.23-5.45-6.95-7.69-11.17-2.25-4.22-3.79-8.64-4.64-13.28-.84-4.64-.84-9.38,0-14.23.84-4.85,2.95-9.52,6.32-14.02,5.9-8.11,13.17-13.54,21.82-16.3,8.64-2.76,17.77-4.07,27.4-3.93,9.62.14,19.21.95,28.77,2.43,9.56,1.48,18.2,2.42,25.93,2.85,6.88-5.87,14.37-11.18,22.45-15.94,8.08-4.75,16.65-8.87,25.72-12.37s18.58-6.19,28.56-8.07c9.98-1.89,20.37-2.83,31.2-2.83,7.73,0,13.84,1.16,18.34,3.48,4.5,2.32,7.55,5.31,9.17,8.96,1.61,3.66,1.93,7.8.95,12.44-.98,4.64-3.06,9.28-6.22,13.91-3.16,4.64-7.31,9.06-12.44,13.28-5.13,4.22-10.93,7.73-17.39,10.54-9.56,4.08-17.67,6.04-24.35,5.9-6.68-.14-11.81-1.65-15.39-4.53-3.58-2.88-5.45-6.64-5.59-11.28-.14-4.64,1.69-9.34,5.48-14.12-3.09.7-6.32,1.34-9.7,1.9-2.81.56-6.04,1.16-9.7,1.79-3.66.63-7.38,1.3-11.17,2-9.42,9.28-17.81,19.64-25.19,31.09-7.38,11.46-13.39,23.08-18.02,34.89-4.64,11.8-7.8,23.26-9.48,34.36-1.69,11.11-1.69,20.97,0,29.62,1.69,8.64,5.27,15.6,10.75,20.87s13.14,7.91,22.98,7.91c4.64,0,8.99-.67,13.07-2,4.07-1.34,7.76-3.06,11.07-5.16,3.3-2.11,6.15-4.5,8.54-7.17,2.39-2.67,4.22-5.34,5.48-8.01l5.27,8.43ZM219.48,113.3c-11.95,0-23.29,2.21-34.04,6.64-10.75,4.43-20.84,10.43-30.25,18.02,7.17-1.69,13.42-3.48,18.76-5.37,5.34-1.9,9.83-3.62,13.49-5.16,4.22-1.82,7.8-3.65,10.75-5.48l3.58,8.64c-9.28,4.08-15.67,8.43-19.18,13.07-3.51,4.64-4.71,8.54-3.58,11.7,1.12,3.16,4.43,5.06,9.91,5.69,5.48.63,12.65-1.02,21.5-4.95,7.17-3.09,13.24-7.06,18.23-11.91,4.99-4.85,8.22-9.56,9.7-14.12,1.48-4.57.81-8.5-2-11.8-2.81-3.3-8.43-4.95-16.86-4.95Z"/>
  <path d="M280.54,337.78h178.68c1.19.15,1.79.75,1.79,1.79l-2.68,1.79h-177.78c-1.19,0-1.79-.59-1.79-1.79.15-1.19.74-1.79,1.79-1.79ZM495.84,323.49h2.68c11.31,2.09,16.97,6.25,16.97,12.51v1.79c0,6.7-5.96,10.57-17.87,11.61h-.89v.89l6.25,1.79h4.47c4.02,0,12.65-6.25,25.91-18.76,8.34-3.57,15.48-5.36,21.44-5.36,1.04,0,5.21.89,12.51,2.68v1.79l-4.47-.89h-2.68c-13.25,0-26.35,7.74-39.31,23.23-5.36,2.98-10.72,4.47-16.08,4.47-11.91-1.93-17.87-6.4-17.87-13.4,0-8.34,6.25-12.51,18.76-12.51-.3-1.79-2.68-2.68-7.15-2.68h-1.79c-5.51,0-13.85,5.66-25.01,16.97-7.3,4.77-14.74,7.15-22.33,7.15-8.34-.74-12.51-1.93-12.51-3.57h5.36c13.7,0,27.1-7.74,40.2-23.23,5.51-2.98,9.97-4.47,13.4-4.47ZM494.06,344.93v1.79h4.47c7.15-1.64,10.72-4.91,10.72-9.83v-.89h-3.57c-6.85,0-10.72,2.98-11.61,8.93ZM548.55,337.78h174.21c1.19.15,1.79.75,1.79,1.79,0,1.19-.6,1.79-1.79,1.79h-175.1c-1.19,0-1.79-.59-1.79-1.79l2.68-1.79Z"/>
  <g>
    <path d="M218,258.12c2.95,0,6.01-.49,9.17-1.48,3.16-.98,6.18-2.28,9.06-3.9,2.88-1.61,5.51-3.51,7.91-5.69,2.39-2.18,4.35-4.46,5.9-6.85l3.58,5.9c-3.51,7.45-9.56,13.28-18.13,17.5-8.57,4.22-18.55,6.32-29.93,6.32-5.9,0-10.93-1.09-15.07-3.27-4.15-2.18-7.34-5.16-9.59-8.96-2.25-3.79-3.44-8.25-3.58-13.39-.14-5.13.91-10.57,3.16-16.34,5.34-13.63,12.47-23.99,21.4-31.09,8.92-7.09,18.79-10.64,29.62-10.64,5.76,0,10.12,1.51,13.07,4.53,2.95,3.02,4.6,6.68,4.95,10.96.35,4.29-.56,8.85-2.74,13.7-2.18,4.85-5.52,9.17-10.01,12.96-6.32,5.2-13.63,7.8-21.92,7.8h-13.49c-1.83,6.33-1.16,11.56,2,15.7,3.16,4.15,8.04,6.22,14.65,6.22ZM226.22,195.73c-1.41.56-3.06,1.83-4.95,3.79s-3.83,4.43-5.8,7.38c-1.97,2.95-3.97,6.25-6.01,9.91-2.04,3.66-3.83,7.45-5.38,11.38h7.38c3.23,0,5.97-.98,8.22-2.95,2.25-1.97,4.35-4.99,6.32-9.06,1.69-3.09,3.02-6.04,4.01-8.85.98-2.81,1.54-5.2,1.69-7.17.14-1.97-.21-3.41-1.05-4.32-.84-.91-2.32-.95-4.43-.1Z"/>
    <path d="M281.45,170.85c4.07,0,6.75,1.58,8.01,4.74,1.27,3.16.98,6.99-.84,11.49-1.26,3.37-2.81,6.18-4.64,8.43h18.55c-.42,1.27-1.19,3.24-2.32,5.9-1.13,2.67-2.39,5.76-3.79,9.27-1.41,3.51-2.92,7.17-4.53,10.96-1.62,3.79-3.13,7.38-4.53,10.75-1.41,3.37-2.63,6.29-3.69,8.75-1.05,2.46-1.72,4.11-2,4.95-1.13,2.67-.99,4.57.42,5.69,1.4,1.13,3.34,1.48,5.8,1.05,2.46-.42,5.09-1.69,7.9-3.79,2.81-2.11,5.13-5.06,6.96-8.85l3.58,5.9c-1.41,3.37-3.34,6.5-5.8,9.38-2.46,2.88-5.2,5.37-8.22,7.48-3.02,2.11-6.25,3.79-9.7,5.06-3.45,1.27-6.85,1.9-10.22,1.9s-6.29-.56-8.75-1.69c-2.46-1.12-4.29-2.81-5.48-5.06-1.2-2.25-1.72-5.06-1.58-8.43.14-3.37,1.12-7.24,2.95-11.59l17.28-41.74c-2.53,1.26-5.2,1.9-8.01,1.9-3.94,0-6.54-1.58-7.8-4.74-1.26-3.16-.92-6.99,1.05-11.49,1.97-5.2,4.67-9.2,8.12-12.02,3.44-2.81,7.2-4.22,11.28-4.22Z"/>
    <path d="M350.17,182.02l-26.35,64.08c-1.13,2.67-.98,4.57.42,5.69,1.4,1.13,3.34,1.48,5.8,1.05,2.46-.42,5.09-1.69,7.9-3.79,2.81-2.11,5.13-5.06,6.96-8.85l3.58,5.9c-1.41,3.37-3.34,6.5-5.8,9.38-2.46,2.88-5.2,5.37-8.22,7.48-3.02,2.11-6.25,3.79-9.7,5.06-3.44,1.27-6.85,1.9-10.22,1.9s-6.29-.56-8.75-1.69c-2.46-1.12-4.32-2.81-5.59-5.06-1.26-2.25-1.82-5.06-1.69-8.43.14-3.37,1.13-7.24,2.95-11.59l25.3-61.13h-12.02l5.9-10.75h10.54l2.53-6.32,25.3-4.85-4.64,11.17h18.97l-5.9,10.75h-17.29Z"/>
    <path d="M390.22,246.1c-1.41,3.37-3.34,6.5-5.8,9.38-2.46,2.88-5.2,5.37-8.22,7.48-3.02,2.11-6.25,3.79-9.7,5.06-3.45,1.27-6.85,1.9-10.22,1.9-6.89,0-11.66-2.25-14.33-6.75-2.67-4.5-2.18-11.17,1.48-20.03.7-1.69,1.79-4.25,3.27-7.69,1.48-3.44,2.98-7.06,4.53-10.86,1.54-3.79,2.98-7.38,4.32-10.75,1.33-3.37,2.35-5.83,3.06-7.38,1.12-2.81,1.26-5.09.42-6.85-.84-1.76-2.88-2.64-6.11-2.64h-2.11l4.43-9.06c1.12-.28,2.32-.56,3.58-.84,1.12-.28,2.35-.49,3.69-.63,1.33-.14,2.7-.21,4.11-.21,8.01,0,13,2.21,14.97,6.64,1.97,4.43,1.05,11.28-2.74,20.55-.84,2.11-2,4.99-3.48,8.64-1.48,3.66-2.99,7.31-4.53,10.96-1.69,4.22-3.45,8.57-5.27,13.07-1.13,2.81-.99,4.78.42,5.9,1.4,1.13,3.34,1.44,5.8.95,2.46-.49,5.09-1.79,7.9-3.9,2.81-2.11,5.13-5.06,6.96-8.85l3.58,5.9ZM399.07,165.79c0,3.51-1.26,6.54-3.79,9.06-2.53,2.53-5.55,3.79-9.06,3.79s-6.75-1.27-9.28-3.79c-2.53-2.53-3.79-5.55-3.79-9.06s1.26-6.53,3.79-9.06c2.53-2.53,5.62-3.79,9.28-3.79s6.54,1.27,9.06,3.79,3.79,5.55,3.79,9.06Z"/>
    <path d="M404.97,195.09c5.48-13.77,12.65-24.21,21.5-31.3,8.85-7.1,18.69-10.65,29.51-10.65,4.5,0,8.08,1.02,10.75,3.06,2.67,2.04,4.5,4.64,5.48,7.8.98,3.16,1.16,6.75.53,10.75-.63,4-1.93,7.9-3.9,11.7-1.83,3.51-3.72,6.43-5.69,8.75-1.97,2.32-3.87,4.15-5.69,5.48-1.83,1.34-3.55,2.28-5.16,2.85-1.62.56-2.92.84-3.9.84-3.94,0-6.5-1.61-7.69-4.85-1.2-3.23-.95-7.1.74-11.6,2.11-5.06,4.88-9.03,8.33-11.91,3.44-2.88,7.27-4.32,11.49-4.32.7,0,1.61.14,2.74.42.28-2.81-.18-5.13-1.37-6.95-1.2-1.83-3.2-2.74-6.01-2.74s-5.55.95-8.22,2.85c-2.67,1.9-5.24,4.39-7.69,7.48-2.46,3.09-4.71,6.61-6.75,10.54-2.04,3.94-3.76,7.87-5.16,11.8l-8.85,21.92c.42,0,.81.04,1.16.11.35.07.66.1.95.1,11.1.42,21.11-1.33,30.04-5.27,8.92-3.93,16.05-11.1,21.39-21.5,1.12-.28,2.32-.56,3.58-.84,1.12-.28,2.35-.49,3.69-.63,1.33-.14,2.7-.21,4.11-.21,2.95,0,5.44.35,7.48,1.05,2.04.7,3.51,1.97,4.43,3.79.91,1.83,1.19,4.22.84,7.17-.35,2.95-1.44,6.68-3.27,11.17-.84,2.11-2.18,5.09-4.01,8.96-1.83,3.87-3.66,7.62-5.48,11.28-2.11,4.5-4.36,9.14-6.75,13.91-1.13,2.81-.99,4.78.42,5.9,1.4,1.13,3.34,1.44,5.8.95,2.46-.49,5.09-1.79,7.9-3.9,2.81-2.11,5.13-5.06,6.96-8.85l3.58,5.9c-1.41,3.37-3.34,6.5-5.8,9.38-2.46,2.88-5.2,5.37-8.22,7.48-3.02,2.11-6.25,3.79-9.7,5.06-3.45,1.27-6.85,1.9-10.22,1.9-6.89,0-11.67-2.25-14.33-6.75-2.67-4.5-2.18-11.17,1.48-20.03.7-1.69,1.86-4.11,3.48-7.27,1.61-3.16,3.3-6.5,5.06-10.02,1.76-3.51,3.37-6.81,4.85-9.91,1.48-3.09,2.56-5.41,3.27-6.95.28-.56.45-1.12.53-1.69.07-.56.17-1.12.32-1.69-1.55,3.52-3.87,6.54-6.96,9.06-3.09,2.53-6.57,4.67-10.43,6.43-3.87,1.76-7.9,3.13-12.12,4.11-4.22.98-8.08,1.55-11.59,1.69.56,1.97.74,4.43.53,7.38-.21,2.95-.7,6.15-1.48,9.59-.77,3.45-1.79,7.06-3.06,10.86s-2.74,7.45-4.43,10.96c-6.19,12.93-12.72,22.77-19.6,29.51-6.89,6.75-13.7,10.12-20.45,10.12s-11.49-2.28-14.23-6.85c-2.74-4.57-2.28-11.21,1.37-19.92l33.94-83.47ZM414.04,263.81c2.81-5.62,4.88-10.78,6.22-15.49,1.33-4.71,2.07-8.71,2.21-12.01.14-3.3-.35-5.83-1.48-7.59-1.13-1.76-2.74-2.56-4.85-2.42l-22.77,55.02c-1.13,2.67-1.34,4.64-.63,5.9.7,1.27,2.04,1.37,4,.32,1.97-1.05,4.46-3.48,7.48-7.27,3.02-3.79,6.29-9.28,9.8-16.44ZM511.64,165.79c0,3.51-1.27,6.54-3.79,9.06-2.53,2.53-5.55,3.79-9.06,3.79s-6.75-1.27-9.28-3.79c-2.53-2.53-3.79-5.55-3.79-9.06s1.26-6.53,3.79-9.06,5.62-3.79,9.28-3.79,6.53,1.27,9.06,3.79c2.53,2.53,3.79,5.55,3.79,9.06Z"/>
    <path d="M575.3,246.1c-3.51,7.45-9.52,13.28-18.02,17.5-8.5,4.22-18.52,6.32-30.04,6.32-5.9,0-10.93-1.09-15.07-3.27-4.15-2.18-7.34-5.16-9.59-8.96-2.25-3.79-3.44-8.25-3.58-13.39-.14-5.13.91-10.57,3.16-16.34,5.48-13.63,12.65-23.99,21.5-31.09,8.85-7.09,18.69-10.64,29.51-10.64,4.5,0,8.08,1.02,10.75,3.06,2.67,2.04,4.5,4.67,5.48,7.91.98,3.23,1.16,6.85.53,10.86-.63,4-1.93,7.9-3.9,11.7-1.83,3.51-3.72,6.4-5.69,8.64-1.97,2.25-3.87,4.04-5.69,5.37-1.83,1.34-3.55,2.25-5.16,2.74-1.62.49-2.92.74-3.9.74-3.94,0-6.5-1.55-7.69-4.64-1.19-3.09-.95-6.88.74-11.38,2.11-5.2,4.88-9.2,8.33-12.01,3.44-2.81,7.27-4.22,11.49-4.22h1.37c.49,0,.88.07,1.16.21.42-2.81.03-5.13-1.16-6.96-1.19-1.82-3.2-2.74-6.01-2.74s-5.55.99-8.22,2.95c-2.67,1.97-5.24,4.5-7.69,7.59-2.46,3.09-4.71,6.57-6.75,10.43-2.04,3.87-3.76,7.77-5.16,11.7-3.79,10.12-4.36,17.64-1.69,22.55,2.67,4.92,7.8,7.38,15.39,7.38,2.95,0,6.01-.49,9.17-1.48,3.16-.98,6.18-2.28,9.06-3.9,2.88-1.61,5.51-3.51,7.91-5.69,2.39-2.18,4.35-4.46,5.9-6.85l3.58,5.9Z"/>
    <path d="M626.1,186.24c5.48,0,9.62,1.97,12.44,5.9.42-.98.74-1.86.95-2.63.21-.77.45-1.3.74-1.58h23.19c-.42,1.27-1.26,3.45-2.53,6.54-1.26,3.09-2.74,6.64-4.43,10.64-1.69,4.01-3.45,8.22-5.27,12.65-1.83,4.43-3.55,8.61-5.16,12.54-1.62,3.94-3.02,7.34-4.22,10.22-1.2,2.88-1.93,4.74-2.21,5.59-1.13,2.67-.99,4.57.42,5.69,1.4,1.13,3.3,1.48,5.69,1.05,2.39-.42,5.02-1.69,7.9-3.79,2.88-2.11,5.23-5.06,7.06-8.85l3.58,5.9c-1.41,3.37-3.34,6.5-5.8,9.38-2.46,2.88-5.2,5.37-8.22,7.48-3.02,2.11-6.25,3.79-9.7,5.06-3.45,1.27-6.85,1.9-10.22,1.9-4.36,0-7.9-.91-10.65-2.74-2.74-1.82-4.46-4.57-5.16-8.22-4.08,3.37-8.19,6.05-12.33,8.01-4.15,1.97-8.12,2.95-11.91,2.95-4.78,0-8.68-1.09-11.7-3.27-3.02-2.18-5.16-5.16-6.43-8.96-1.27-3.79-1.65-8.25-1.16-13.39.49-5.13,2-10.57,4.53-16.34,6.04-14.33,13.56-24.87,22.56-31.62,8.99-6.75,18.34-10.12,28.04-10.12ZM634.95,200.36c-1.26-1.97-3.3-2.95-6.11-2.95s-5.16.53-7.48,1.58c-2.32,1.05-4.64,2.74-6.96,5.06s-4.67,5.37-7.06,9.17c-2.39,3.79-4.92,8.43-7.59,13.91-2.11,4.08-3.76,7.91-4.95,11.49-1.2,3.58-1.86,6.71-2,9.38-.14,2.67.32,4.78,1.37,6.32,1.05,1.55,2.77,2.32,5.16,2.32s4.99-.7,7.8-2.11c2.81-1.4,5.62-3.37,8.43-5.9.42-1.82,1.05-3.65,1.9-5.48l17.5-42.79Z"/>
    <path d="M715.05,186.24c5.48,0,9.62,1.97,12.44,5.9l7.8-18.97c1.26-2.81,1.44-5.09.53-6.85-.92-1.76-2.92-2.64-6.01-2.64h-2.11l4.22-9.06c1.12-.14,2.32-.35,3.58-.63,1.12-.28,2.35-.49,3.69-.63,1.33-.14,2.7-.21,4.11-.21,8.01,0,13.03,2.18,15.07,6.54,2.04,4.36,1.09,11.24-2.85,20.66l-26.98,65.77c-.99,2.81-.81,4.78.53,5.9,1.33,1.13,3.23,1.44,5.69.95,2.46-.49,5.09-1.79,7.9-3.9,2.81-2.11,5.13-5.06,6.96-8.85l3.58,5.9c-1.41,3.37-3.34,6.5-5.8,9.38-2.46,2.88-5.2,5.37-8.22,7.48-3.02,2.11-6.25,3.79-9.7,5.06-3.45,1.27-6.85,1.9-10.22,1.9-4.36,0-7.87-.88-10.54-2.63-2.67-1.76-4.36-4.46-5.06-8.12-4.08,3.37-8.22,6.01-12.44,7.9-4.22,1.9-8.22,2.85-12.01,2.85-4.78,0-8.68-1.09-11.7-3.27-3.02-2.18-5.16-5.16-6.43-8.96-1.27-3.79-1.65-8.25-1.16-13.39.49-5.13,2-10.57,4.53-16.34,6.18-14.33,13.73-24.87,22.66-31.62,8.92-6.75,18.23-10.12,27.93-10.12ZM706.41,243.15c.42-.98,1.23-2.91,2.42-5.8,1.19-2.88,2.63-6.29,4.32-10.22,1.69-3.93,3.48-8.25,5.38-12.96,1.9-4.71,3.76-9.31,5.59-13.81-1.55-1.97-3.66-2.95-6.32-2.95-5.2,0-9.98,2.21-14.33,6.64-4.36,4.43-9.28,12.12-14.76,23.08-1.97,4.08-3.55,7.91-4.74,11.49-1.2,3.58-1.86,6.71-2,9.38-.14,2.67.32,4.78,1.37,6.32,1.05,1.55,2.77,2.32,5.16,2.32s4.92-.7,7.59-2.11c2.67-1.4,5.41-3.3,8.22-5.69.28-.98.6-1.9.95-2.74.35-.84.74-1.82,1.16-2.95Z"/>
    <path d="M803.8,186.24c5.06,0,9.31,1.09,12.75,3.27,3.44,2.18,5.94,5.16,7.48,8.96,1.54,3.79,2.18,8.22,1.9,13.28-.28,5.06-1.55,10.47-3.79,16.23-2.53,6.61-5.62,12.47-9.28,17.6-3.66,5.13-7.69,9.52-12.12,13.18-4.43,3.66-9.14,6.43-14.12,8.33-4.99,1.9-10.15,2.85-15.49,2.85s-9.49-1.09-12.86-3.27-5.83-5.16-7.38-8.96-2.14-8.25-1.79-13.39c.35-5.13,1.65-10.57,3.9-16.34,5.34-13.35,12.4-23.64,21.19-30.88,8.78-7.24,18.66-10.86,29.62-10.86ZM798.53,228.29c1.69-4.34,3.06-8.47,4.11-12.4,1.05-3.92,1.72-7.39,2-10.4.28-3.01.14-5.43-.42-7.25-.56-1.82-1.69-2.73-3.37-2.73s-3.58.91-5.69,2.73-4.25,4.24-6.43,7.25c-2.18,3.01-4.32,6.48-6.43,10.4-2.11,3.92-4.01,8.06-5.69,12.4-1.69,4.2-3.09,8.23-4.22,12.08-1.13,3.85-1.79,7.25-2,10.19s.03,5.29.74,7.04c.7,1.75,1.9,2.62,3.58,2.62s3.55-.87,5.59-2.62c2.04-1.75,4.11-4.1,6.22-7.04s4.22-6.34,6.32-10.19c2.11-3.85,4.01-7.88,5.69-12.08Z"/>
  </g>
  <g>
    <path d="M385.51,64.35c-3.8,3.51-7.08,7.99-9.83,13.44-2.76,5.45-5.46,11.28-8.12,17.49-2.66,6.21-5.44,12.52-8.34,18.93-2.9,6.41-6.39,12.35-10.47,17.81-4.09,5.46-8.93,10.14-14.54,14.04-5.61,3.89-12.4,6.46-20.38,7.69-7.6,1.14-13.92.9-18.95-.71-5.04-1.62-8.91-4.13-11.61-7.55-2.71-3.42-4.37-7.46-4.99-12.11-.62-4.66-.31-9.43.93-14.32,1.23-4.89,3.3-9.67,6.2-14.31,2.9-4.65,6.48-8.63,10.76-11.95-1.99-4.08-3.09-8.51-3.28-13.3-.19-4.79.43-9.72,1.85-14.79,1.42-5.07,3.61-10.19,6.56-15.36,2.94-5.17,6.65-10.12,11.12-14.86-3.9,0-7.74.12-11.54.36-3.8.24-7.55.85-11.26,1.85s-7.39,2.42-11.04,4.28c-3.66,1.85-7.25,4.35-10.76,7.48-3.33,2.95-5.77,6.03-7.34,9.26-1.57,3.23-2.42,6.34-2.57,9.33-.14,2.99.38,5.68,1.57,8.05,1.19,2.38,2.92,4.18,5.2,5.42l-6.7,3.28c-2.95-.29-5.94-1.88-8.98-4.77-3.04-2.9-5.44-6.56-7.2-10.97-1.76-4.42-2.45-9.24-2.07-14.46.38-5.22,2.52-10.26,6.41-15.11,3.04-3.8,6.48-6.72,10.33-8.76,3.85-2.04,7.88-3.47,12.11-4.27,4.23-.81,8.57-1.14,13.04-1,4.46.14,8.88.48,13.25,1,4.37.52,8.6,1.07,12.68,1.64,4.08.57,7.88.85,11.4.85,4.56-3.99,9.64-7.7,15.25-11.12,5.6-3.42,11.71-6.39,18.31-8.91,6.6-2.52,13.66-4.46,21.16-5.84,7.5-1.38,15.44-2.07,23.8-2.07,6.27,0,11,1.16,14.18,3.49,3.18,2.33,5.03,5.3,5.56,8.91.52,3.61-.12,7.55-1.92,11.83-1.81,4.28-4.51,8.36-8.12,12.26-3.61,3.9-8.03,7.34-13.25,10.33-5.23,2.99-10.93,4.92-17.1,5.77-5.8.85-10.43.57-13.89-.86-3.47-1.42-5.82-3.42-7.05-5.98-1.24-2.57-1.33-5.51-.28-8.84,1.04-3.32,3.13-6.51,6.27-9.55l-7.13,1.42c-2.19.47-4.66.95-7.41,1.42-2.76.47-5.51.95-8.27,1.42-4.75,4.84-8.81,10.01-12.18,15.51-3.37,5.5-5.98,10.95-7.84,16.36-1.85,5.41-2.9,10.57-3.14,15.5-.24,4.93.47,9.29,2.14,13.09,1.66,3.79,4.27,6.83,7.84,9.1,3.56,2.28,8.24,3.41,14.04,3.41h1.57c.57,0,1.14-.05,1.71-.14,2.37-5.12,4.82-10.15,7.34-15.07,2.52-4.93,5.25-9.43,8.19-13.51,2.94-4.08,6.22-7.49,9.83-10.24,3.61-2.75,7.65-4.5,12.11-5.26l4.85,3.98ZM337.77,113.01c-9.12,0-16.72-1.24-22.8-3.71-6.08-2.47-10.93-5.79-14.54-9.98-3.14,2.56-5.75,5.56-7.84,8.98-2.09,3.42-3.61,6.93-4.56,10.55-.95,3.61-1.28,7.17-1,10.69.29,3.51,1.26,6.63,2.92,9.33,1.66,2.71,4.04,4.82,7.12,6.34,3.09,1.52,7.01,2.14,11.76,1.85,3.42-.19,6.53-1.26,9.33-3.21,2.8-1.95,5.42-4.47,7.84-7.55,2.42-3.09,4.7-6.63,6.84-10.62,2.14-3.99,4.25-8.22,6.34-12.68h-1.43ZM375.68,45.17c4.56-.57,8.88-1.92,12.97-4.06,4.08-2.14,7.65-4.63,10.69-7.48,3.04-2.85,5.44-5.86,7.2-9.05,1.76-3.18,2.61-6.1,2.57-8.76-.05-2.66-1.14-4.87-3.28-6.63-2.14-1.76-5.58-2.64-10.33-2.64-9.6,0-18.43,1.64-26.51,4.92-8.08,3.28-15.39,7.58-21.95,12.9,5.42-1.14,10.17-2.37,14.25-3.71,4.08-1.33,7.5-2.61,10.26-3.85,3.23-1.33,5.99-2.71,8.27-4.13l2,6.13c-2.56.38-5.06,1.33-7.48,2.85-2.42,1.52-4.49,3.35-6.2,5.49-1.71,2.14-3.02,4.37-3.92,6.7-.9,2.33-1.16,4.4-.78,6.2.38,1.81,1.54,3.23,3.49,4.27,1.95,1.05,4.87,1.33,8.76.85Z"/>
    <path d="M421.14,97.05c2,0,4.06-.33,6.2-1,2.14-.66,4.18-1.54,6.13-2.64,1.95-1.09,3.73-2.37,5.34-3.85,1.61-1.47,2.94-3.01,3.99-4.63l2.42,3.99c-2.38,5.04-6.46,8.98-12.25,11.83-5.8,2.85-12.54,4.28-20.24,4.28-3.99,0-7.39-.74-10.19-2.21-2.8-1.47-4.97-3.49-6.48-6.06-1.52-2.57-2.33-5.58-2.42-9.05-.09-3.47.62-7.15,2.14-11.04,3.61-9.21,8.43-16.22,14.46-21.02,6.03-4.8,12.71-7.2,20.02-7.2,3.89,0,6.84,1.02,8.83,3.06,2,2.04,3.11,4.51,3.35,7.41.24,2.9-.38,5.99-1.85,9.26-1.47,3.28-3.73,6.2-6.77,8.76-4.28,3.52-9.22,5.27-14.82,5.27h-9.12c-1.24,4.27-.78,7.82,1.35,10.62,2.14,2.8,5.44,4.2,9.9,4.2ZM426.7,54.86c-.95.38-2.07,1.24-3.35,2.57-1.28,1.33-2.59,2.99-3.92,4.99-1.33,2-2.69,4.23-4.06,6.7-1.38,2.47-2.59,5.04-3.63,7.7h4.99c2.18,0,4.04-.66,5.56-2,1.52-1.33,2.94-3.37,4.28-6.13,1.14-2.09,2.04-4.08,2.71-5.99.66-1.9,1.04-3.51,1.14-4.85.09-1.33-.14-2.3-.71-2.92-.57-.62-1.57-.64-2.99-.07Z"/>
    <path d="M464.03,38.05c2.75,0,4.56,1.07,5.42,3.21.86,2.14.66,4.73-.57,7.77-.85,2.28-1.9,4.18-3.13,5.7h12.54c-.29.85-.81,2.19-1.57,3.99-.76,1.81-1.62,3.9-2.56,6.27-.95,2.38-1.97,4.85-3.06,7.41-1.09,2.56-2.12,4.99-3.06,7.27-.95,2.28-1.78,4.25-2.49,5.91-.71,1.66-1.16,2.78-1.35,3.35-.76,1.81-.67,3.09.29,3.85.95.76,2.25,1,3.92.71,1.66-.29,3.44-1.14,5.34-2.56,1.9-1.43,3.47-3.42,4.7-5.99l2.42,3.99c-.95,2.28-2.26,4.4-3.92,6.34-1.66,1.95-3.52,3.63-5.56,5.06-2.04,1.42-4.23,2.56-6.55,3.42-2.33.85-4.63,1.28-6.91,1.28s-4.25-.38-5.91-1.14c-1.66-.76-2.9-1.9-3.71-3.42-.81-1.52-1.16-3.42-1.07-5.7.09-2.28.76-4.89,2-7.84l11.69-28.22c-1.71.85-3.52,1.28-5.42,1.28-2.66,0-4.42-1.07-5.27-3.21-.85-2.14-.62-4.72.71-7.77,1.33-3.51,3.16-6.22,5.49-8.12,2.33-1.9,4.87-2.85,7.62-2.85Z"/>
    <path d="M515.19,48.45c3.71,0,6.51,1.33,8.41,3.99.29-.66.5-1.26.64-1.78.14-.52.31-.88.5-1.07h15.68c-.29.85-.86,2.33-1.71,4.42-.86,2.09-1.85,4.49-2.99,7.2-1.14,2.71-2.33,5.56-3.56,8.55-1.24,2.99-2.4,5.82-3.49,8.48-1.09,2.66-2.04,4.97-2.85,6.91-.81,1.95-1.31,3.21-1.5,3.78-.76,1.81-.67,3.09.29,3.85.95.76,2.23,1,3.85.71,1.61-.29,3.4-1.14,5.34-2.56,1.95-1.43,3.54-3.42,4.77-5.99l2.42,3.99c-.95,2.28-2.26,4.4-3.92,6.34-1.66,1.95-3.52,3.63-5.56,5.06-2.04,1.42-4.23,2.56-6.55,3.42-2.33.85-4.63,1.28-6.91,1.28-2.95,0-5.34-.62-7.2-1.85s-3.02-3.09-3.49-5.56c-2.76,2.28-5.54,4.09-8.34,5.42-2.8,1.33-5.49,2-8.05,2-3.23,0-5.87-.74-7.91-2.21-2.04-1.47-3.49-3.49-4.35-6.06-.86-2.57-1.12-5.58-.78-9.05.33-3.47,1.35-7.15,3.06-11.04,4.08-9.69,9.17-16.82,15.25-21.38,6.08-4.56,12.4-6.84,18.95-6.84ZM521.18,58c-.86-1.33-2.23-2-4.13-2s-3.49.36-5.06,1.07c-1.57.71-3.14,1.85-4.7,3.42-1.57,1.57-3.16,3.63-4.77,6.2-1.62,2.56-3.33,5.7-5.13,9.41-1.42,2.76-2.54,5.34-3.35,7.77-.81,2.42-1.26,4.54-1.35,6.34-.1,1.81.21,3.23.93,4.28.71,1.05,1.88,1.57,3.49,1.57s3.37-.47,5.27-1.42c1.9-.95,3.8-2.28,5.7-3.99.28-1.23.71-2.47,1.28-3.71l11.83-28.93Z"/>
    <path d="M575.33,48.45c3.71,0,6.51,1.33,8.41,3.99l5.27-12.83c.85-1.9.97-3.44.36-4.63-.62-1.19-1.97-1.78-4.06-1.78h-1.43l2.85-6.13c.76-.09,1.57-.24,2.42-.43.76-.19,1.59-.33,2.49-.43.9-.09,1.83-.14,2.78-.14,5.42,0,8.81,1.47,10.19,4.42,1.38,2.95.73,7.6-1.92,13.97l-18.24,44.46c-.67,1.9-.55,3.23.36,3.99.9.76,2.18.98,3.85.64,1.66-.33,3.44-1.21,5.34-2.64,1.9-1.43,3.47-3.42,4.7-5.99l2.42,3.99c-.95,2.28-2.26,4.4-3.92,6.34-1.66,1.95-3.52,3.63-5.56,5.06-2.04,1.42-4.23,2.56-6.55,3.42-2.33.85-4.63,1.28-6.91,1.28-2.95,0-5.32-.59-7.12-1.78-1.81-1.19-2.95-3.02-3.42-5.49-2.76,2.28-5.56,4.06-8.41,5.34-2.85,1.28-5.56,1.92-8.12,1.92-3.23,0-5.87-.74-7.91-2.21-2.04-1.47-3.49-3.49-4.35-6.06-.86-2.57-1.12-5.58-.78-9.05.33-3.47,1.35-7.15,3.06-11.04,4.18-9.69,9.29-16.82,15.32-21.38,6.03-4.56,12.33-6.84,18.88-6.84ZM569.49,86.93c.29-.66.83-1.97,1.64-3.92.81-1.95,1.78-4.25,2.92-6.91,1.14-2.66,2.35-5.58,3.63-8.76,1.28-3.18,2.54-6.29,3.78-9.33-1.05-1.33-2.47-2-4.28-2-3.52,0-6.75,1.5-9.69,4.49-2.95,2.99-6.27,8.19-9.98,15.6-1.33,2.76-2.4,5.34-3.21,7.77-.81,2.42-1.26,4.54-1.35,6.34-.1,1.81.21,3.23.93,4.28.71,1.05,1.88,1.57,3.49,1.57s3.32-.47,5.13-1.42c1.8-.95,3.66-2.23,5.56-3.85.19-.66.4-1.28.64-1.85.24-.57.5-1.23.78-2Z"/>
    <path d="M635.32,48.45c3.42,0,6.29.74,8.62,2.21,2.33,1.47,4.01,3.49,5.06,6.06,1.04,2.57,1.47,5.56,1.28,8.98-.19,3.42-1.05,7.08-2.57,10.97-1.71,4.47-3.8,8.43-6.27,11.9-2.47,3.47-5.2,6.44-8.19,8.91-2.99,2.47-6.18,4.35-9.55,5.63-3.37,1.28-6.87,1.92-10.47,1.92s-6.41-.74-8.69-2.21c-2.28-1.47-3.94-3.49-4.99-6.06-1.04-2.57-1.45-5.58-1.21-9.05.24-3.47,1.12-7.15,2.64-11.04,3.61-9.02,8.38-15.98,14.32-20.88,5.94-4.89,12.61-7.34,20.02-7.34ZM631.76,76.88c1.14-2.93,2.07-5.73,2.78-8.38.71-2.65,1.16-4.99,1.35-7.03.19-2.04.09-3.67-.29-4.9-.38-1.23-1.14-1.85-2.28-1.85s-2.42.62-3.85,1.85c-1.42,1.23-2.88,2.87-4.35,4.9-1.47,2.04-2.92,4.38-4.35,7.03-1.42,2.65-2.71,5.45-3.85,8.38-1.14,2.84-2.09,5.56-2.85,8.17-.76,2.6-1.21,4.9-1.35,6.89s.02,3.57.5,4.76c.47,1.18,1.28,1.77,2.42,1.77s2.4-.59,3.78-1.77c1.38-1.18,2.78-2.77,4.2-4.76s2.85-4.28,4.28-6.89,2.71-5.33,3.85-8.17Z"/>
    <path d="M673.37,38.05c2.75,0,4.56,1.07,5.42,3.21.86,2.14.66,4.73-.57,7.77-.85,2.28-1.9,4.18-3.13,5.7h12.54c-.29.85-.81,2.19-1.57,3.99-.76,1.81-1.62,3.9-2.56,6.27-.95,2.38-1.97,4.85-3.06,7.41-1.09,2.56-2.12,4.99-3.06,7.27-.95,2.28-1.78,4.25-2.49,5.91-.71,1.66-1.16,2.78-1.35,3.35-.76,1.81-.67,3.09.29,3.85.95.76,2.25,1,3.92.71,1.66-.29,3.44-1.14,5.34-2.56,1.9-1.43,3.47-3.42,4.7-5.99l2.42,3.99c-.95,2.28-2.26,4.4-3.92,6.34-1.66,1.95-3.52,3.63-5.56,5.06-2.04,1.42-4.23,2.56-6.55,3.42-2.33.85-4.63,1.28-6.91,1.28s-4.25-.38-5.91-1.14c-1.66-.76-2.9-1.9-3.71-3.42-.81-1.52-1.16-3.42-1.07-5.7.09-2.28.76-4.89,2-7.84l11.69-28.22c-1.71.85-3.52,1.28-5.42,1.28-2.66,0-4.42-1.07-5.27-3.21-.85-2.14-.62-4.72.71-7.77,1.33-3.51,3.16-6.22,5.49-8.12,2.33-1.9,4.87-2.85,7.62-2.85Z"/>
    <path d="M751.18,48.45c3.71,0,6.51,1.33,8.41,3.99l5.27-12.83c.85-1.9.97-3.44.36-4.63-.62-1.19-1.97-1.78-4.06-1.78h-1.43l2.85-6.13c.76-.09,1.57-.24,2.42-.43.76-.19,1.59-.33,2.49-.43.9-.09,1.83-.14,2.78-.14,5.42,0,8.81,1.47,10.19,4.42,1.38,2.95.73,7.6-1.92,13.97l-18.24,44.46c-.67,1.9-.55,3.23.36,3.99.9.76,2.18.98,3.85.64,1.66-.33,3.44-1.21,5.34-2.64,1.9-1.43,3.47-3.42,4.7-5.99l2.42,3.99c-.95,2.28-2.26,4.4-3.92,6.34-1.66,1.95-3.52,3.63-5.56,5.06-2.04,1.42-4.23,2.56-6.55,3.42-2.33.85-4.63,1.28-6.91,1.28-2.95,0-5.32-.59-7.12-1.78-1.81-1.19-2.95-3.02-3.42-5.49-2.76,2.28-5.56,4.06-8.41,5.34-2.85,1.28-5.56,1.92-8.12,1.92-3.23,0-5.87-.74-7.91-2.21-2.04-1.47-3.49-3.49-4.35-6.06-.86-2.57-1.12-5.58-.78-9.05.33-3.47,1.35-7.15,3.06-11.04,4.18-9.69,9.29-16.82,15.32-21.38,6.03-4.56,12.33-6.84,18.88-6.84ZM745.34,86.93c.29-.66.83-1.97,1.64-3.92.81-1.95,1.78-4.25,2.92-6.91,1.14-2.66,2.35-5.58,3.63-8.76,1.28-3.18,2.54-6.29,3.78-9.33-1.05-1.33-2.47-2-4.28-2-3.52,0-6.75,1.5-9.69,4.49-2.95,2.99-6.27,8.19-9.98,15.6-1.33,2.76-2.4,5.34-3.21,7.77-.81,2.42-1.26,4.54-1.35,6.34-.1,1.81.21,3.23.93,4.28.71,1.05,1.88,1.57,3.49,1.57s3.32-.47,5.13-1.42c1.8-.95,3.66-2.23,5.56-3.85.19-.66.4-1.28.64-1.85.24-.57.5-1.23.78-2Z"/>
    <path d="M801.91,97.05c2,0,4.06-.33,6.2-1,2.14-.66,4.18-1.54,6.13-2.64,1.95-1.09,3.73-2.37,5.34-3.85,1.61-1.47,2.94-3.01,3.99-4.63l2.42,3.99c-2.38,5.04-6.46,8.98-12.25,11.83-5.8,2.85-12.54,4.28-20.24,4.28-3.99,0-7.39-.74-10.19-2.21-2.8-1.47-4.96-3.49-6.48-6.06-1.52-2.57-2.33-5.58-2.42-9.05-.09-3.47.62-7.15,2.14-11.04,3.61-9.21,8.43-16.22,14.46-21.02,6.03-4.8,12.71-7.2,20.02-7.2,3.89,0,6.84,1.02,8.83,3.06,2,2.04,3.11,4.51,3.35,7.41.24,2.9-.38,5.99-1.85,9.26-1.47,3.28-3.73,6.2-6.77,8.76-4.28,3.52-9.22,5.27-14.82,5.27h-9.12c-1.24,4.27-.78,7.82,1.35,10.62,2.14,2.8,5.44,4.2,9.9,4.2ZM807.47,54.86c-.95.38-2.07,1.24-3.35,2.57-1.28,1.33-2.59,2.99-3.92,4.99-1.33,2-2.69,4.23-4.06,6.7-1.38,2.47-2.59,5.04-3.63,7.7h4.99c2.18,0,4.04-.66,5.56-2,1.52-1.33,2.94-3.37,4.28-6.13,1.14-2.09,2.04-4.08,2.71-5.99.66-1.9,1.04-3.51,1.14-4.85.09-1.33-.14-2.3-.71-2.92-.57-.62-1.57-.64-2.99-.07Z"/>
  </g>
</svg>
          </div>

          <div className="space-y-5">
            <div className="space-y-3">
              <div>
                <label className="block text-sm font-semibold text-gray-700 mb-1">Período</label>
                <select 
                  value={periodo} 
                  onChange={(e) => setPeriodo(e.target.value)}
                  className="w-full p-2 border border-gray-300 rounded text-sm"
                >
                  <option value="1 MÊS">1 MÊS</option>
                  <option value="3 MESES">3 MESES</option>
                  <option value="6 MESES">6 MESES</option>
                  <option value="1 ANO">1 ANO</option>
                  <option value="OUTRO">OUTRO (Upload Manual)</option>
                </select>
                {periodo !== 'OUTRO' && (
                  <p className="text-[10px] text-blue-600 mt-1 flex items-center gap-1">
                    <AlertCircle size={10} /> O fundo muda com o Período e Plano.
                  </p>
                )}
              </div>

              <div>
                <label className="block text-sm font-semibold text-gray-700 mb-1">Nome do Evento</label>
                <input 
                  type="text" 
                  value={nomeEvento}
                  onChange={(e) => setNomeEvento(e.target.value)}
                  placeholder="Ex: Desafio Novembro Azul"
                  className="w-full p-2 border border-gray-300 rounded text-sm"
                />
                <p className="text-[10px] text-gray-400 mt-1">
                  *Maiúsculas automáticas (exceto siglas).
                </p>
              </div>

              <div className="flex gap-2">
                <div className="w-1/3">
                  <label className="block text-xs text-gray-500 mb-1">Preposição</label>
                  <select value={artigoEvento} onChange={(e) => setArtigoEvento(e.target.value)} className="w-full p-2 bg-gray-50 border border-gray-300 rounded text-sm">
                    <option value="ao">ao</option>
                    <option value="à">à</option>
                  </select>
                </div>
                <div className="flex-1">
                  <label className="block text-xs text-gray-500 mb-1">Plano (Troca Fundo)</label>
                  <div className="flex border rounded overflow-hidden">
                      <button onClick={() => setPlano('ouro')} className={`flex-1 py-2 text-xs font-medium ${plano === 'ouro' ? 'bg-blue-600 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'}`}>Ouro</button>
                      <button onClick={() => setPlano('box_k')} className={`flex-1 py-2 text-xs font-medium ${plano === 'box_k' ? 'bg-black text-white' : 'bg-white text-gray-600 hover:bg-gray-50'}`}>Box K</button>
                  </div>
                </div>
              </div>

              <div>
                <label className="block text-sm font-semibold text-gray-700 mb-1 flex items-center gap-1">
                  <Calendar size={14} /> Data de Retirada
                </label>
                <input 
                  type="date" 
                  value={dataRetirada}
                  onChange={(e) => setDataRetirada(e.target.value)}
                  className="w-full p-2 border border-gray-300 rounded text-sm"
                />
              </div>
            </div>

            <div className="bg-gray-50 p-3 rounded-lg border border-gray-200 mt-6">
              <div className="flex items-center justify-between mb-2">
                <h3 className="text-sm font-bold text-gray-700 flex items-center gap-2">
                  <Upload size={14}/> Fundo Manual
                </h3>
              </div>
              <p className="text-[10px] text-gray-500 mb-2">
                O fundo é automático. Use isto apenas se precisar substituir a imagem padrão.
              </p>
              <input type="file" className="block w-full text-xs text-gray-500 file:mr-2 file:py-1 file:px-2 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" accept="image/*" onChange={(e) => handleImageUpload(e, setFundoCertificado)} />
            </div>

            <div className="pt-4 space-y-2 border-t mt-4">
              <h3 className="text-sm font-bold text-gray-700">Exportar</h3>
              <div className="grid grid-cols-2 gap-2">
                  <button 
                    onClick={downloadPDF}
                    disabled={isGenerating || !fundoCertificado}
                    className="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-3 rounded shadow flex items-center justify-center gap-1 transition text-sm disabled:opacity-50"
                  >
                    {isGenerating ? <Loader size={14} className="animate-spin"/> : <FileText size={16} />} 
                    Baixar PDF
                  </button>
                  <button 
                    onClick={downloadJPG}
                    disabled={isGenerating || !fundoCertificado}
                    className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-3 rounded shadow flex items-center justify-center gap-1 transition text-sm disabled:opacity-50"
                  >
                    {isGenerating ? <Loader size={14} className="animate-spin"/> : <ImageIcon size={16} />} 
                    Baixar JPG
                  </button>
              </div>
              <button 
                onClick={() => window.print()}
                disabled={!fundoCertificado}
                className="w-full bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-3 rounded shadow flex items-center justify-center gap-2 transition text-xs disabled:opacity-50"
              >
                <Download size={14} /> Imprimir (Nativo)
              </button>
            </div>
          </div>
        </div>

        {/* RODAPÉ DO MENU PARA INDICAR VERSÃO */}
        <div className="pt-4 mt-4 border-t border-gray-200 text-center">
          <p className="text-[10px] text-gray-400 font-mono">
            Versão 2.2 - Correção XML/Comentários
          </p>
        </div>
      </div>

      {/* --- ÁREA DE PRÉ-VISUALIZAÇÃO (Direita) --- */}
      <div className="flex-1 bg-gray-300 flex items-center justify-center p-4 md:p-8 overflow-auto">
        <div 
          ref={certificateRef}
          className="print-area relative bg-white shadow-2xl overflow-hidden text-black flex-shrink-0"
          style={{ width: '1123px', height: '794px' }} 
        >
          {fundoCertificado ? (
            <img 
              src={fundoCertificado} 
              alt="Fundo do Certificado" 
              className="absolute inset-0 w-full h-full object-cover z-0"
              onError={(e) => {
                e.target.onerror = null; 
                e.target.src = "https://via.placeholder.com/1123x794?text=Imagem+N%C3%A3o+Encontrada+no+Servidor+(Verifique+public/img_fundos)";
              }}
            />
          ) : (
            <div className="absolute inset-0 z-0 flex flex-col items-center justify-center bg-gray-100 text-gray-400 p-10 border-4 border-dashed border-gray-300 m-4 rounded-xl">
              <ImageIcon size={48} className="mb-4 opacity-50"/>
              <p className="text-xl font-semibold">Aguardando Fundo...</p>
              <p className="text-sm mt-2">Selecione um período ou faça upload manual se for "OUTRO".</p>
              <p className="text-xs mt-4 text-red-400">Certifique-se de que as imagens estão na pasta <code>public/img_fundos</code>.</p>
            </div>
          )}

          <div className="absolute top-0 right-0 w-[65%] h-full flex flex-col pt-16 pr-20 pb-10 text-right z-20">
            <div className="mb-14 flex flex-col items-end h-24 justify-center">
               {!fundoCertificado && <span className="font-garamond italic font-bold text-8xl tracking-tighter mr-4 text-black">Certificado</span>}
            </div>

            <div className="mt-8 space-y-2">
              <h2 className="font-garamond text-[33.7pt] uppercase tracking-normal text-gray-900 mb-2">
                PARABÉNS!
              </h2>
              <p className="font-garamond text-2xl text-black mb-10">
                Você agora faz parte da família Korpus!
              </p>

              <div className="font-garamond text-[20pt] leading-snug text-gray-800 w-[90%] ml-auto">
                Este certificado contempla {getPeriodoExtenso(periodo)} de Academia Korpus no{' '}
                <span className="font-bold">
                  {plano === 'ouro' ? 'Plano Ouro' : 'Plano Ouro Box K'}
                </span>{' '}
                como premiação {artigoEvento} <br/>
                <span className="font-bold text-2xl">{formatarNomeEvento(nomeEvento) || '................................'}</span>
              </div>
            </div>

            <div className="mt-8 font-garamond text-[11pt] text-gray-600 w-[80%] ml-auto leading-tight">
              *Bolsa intransferível. O resgate pode ser feito do dia <br/>
              <span className="font-bold">{dataRetiradaFormatada}</span> até <span className="font-bold">{dataFinal}</span> na recepção da unidade de sua escolha.
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
